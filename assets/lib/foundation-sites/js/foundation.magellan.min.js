!function(t,i){"use strict";function e(n,o){this.$element=n,this.options=i.extend({},e.defaults,this.$element.data(),o),this._init(),t.registerPlugin(this,"Magellan")}e.defaults={animationDuration:500,animationEasing:"linear",threshold:50,activeClass:"active",deepLinking:!1,barOffset:0},e.prototype._init=function(){var e=this.$element[0].id||t.GetYoDigits(6,"magellan");this.$targets=i("[data-magellan-target]"),this.$links=this.$element.find("a"),this.$element.attr({"data-resize":e,"data-scroll":e,id:e}),this.$active=i(),this.scrollPos=parseInt(window.pageYOffset,10),this._events()},e.prototype.calcPoints=function(){var t=this,e=document.body,n=document.documentElement;this.points=[],this.winHeight=Math.round(Math.max(window.innerHeight,n.clientHeight)),this.docHeight=Math.round(Math.max(e.scrollHeight,e.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight)),this.$targets.each(function(){var e=i(this),n=Math.round(e.offset().top-t.options.threshold);e.targetPoint=n,t.points.push(n)})},e.prototype._events=function(){var t=this;i("html, body"),{duration:t.options.animationDuration,easing:t.options.animationEasing};i(window).one("load",function(){t.options.deepLinking&&location.hash&&t.scrollToLoc(location.hash),t.calcPoints(),t._updateActive()}),this.$element.on({"resizeme.zf.trigger":this.reflow.bind(this),"scrollme.zf.trigger":this._updateActive.bind(this)}).on("click.zf.magellan",'a[href^="#"]',function(i){i.preventDefault();var e=this.getAttribute("href");t.scrollToLoc(e)})},e.prototype.scrollToLoc=function(t){var e=i(t).offset().top-this.options.threshold/2-this.options.barOffset;i(document.body).stop(!0).animate({scrollTop:e},{duration:this.options.animationDuration,easiing:this.options.animationEasing})},e.prototype.reflow=function(){this.calcPoints(),this._updateActive()},e.prototype._updateActive=function(){var t,i=parseInt(window.pageYOffset,10);if(i+this.winHeight===this.docHeight)t=this.points.length-1;else if(i<this.points[0])t=0;else{var e=this.scrollPos<i,n=this,o=this.points.filter(function(t,o){return e?i>=t:t-n.options.threshold<=i});t=o.length?o.length-1:0}if(this.$active.removeClass(this.options.activeClass),this.$active=this.$links.eq(t).addClass(this.options.activeClass),this.options.deepLinking){var s=this.$active[0].getAttribute("href");window.history.pushState?window.history.pushState(null,null,s):window.location.hash=s}this.scrollPos=i,this.$element.trigger("update.zf.magellan",[this.$active])},e.prototype.destroy=function(){if(this.$element.off(".zf.trigger .zf.magellan").find("."+this.options.activeClass).removeClass(this.options.activeClass),this.options.deepLinking){var i=this.$active[0].getAttribute("href");window.location.hash.replace(i,"")}t.unregisterPlugin(this)},t.plugin(e,"Magellan"),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=e),"function"==typeof define&&define(["foundation"],function(){return e})}(Foundation,jQuery);