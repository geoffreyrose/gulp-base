!function(e,n){"use strict";function t(i,o){this.$element=i,this.options=e.extend({},t.defaults,this.$element.data(),o),n.Nest.Feather(this.$element,"dropdown"),this._init(),n.registerPlugin(this,"DropdownMenu"),n.Keyboard.register("DropdownMenu",{ENTER:"open",SPACE:"open",ARROW_RIGHT:"next",ARROW_UP:"up",ARROW_DOWN:"down",ARROW_LEFT:"previous",ESCAPE:"close"})}t.defaults={disableHover:!1,autoclose:!0,hoverDelay:50,clickOpen:!1,closingTime:500,alignment:"left",closeOnClick:!0,verticalClass:"vertical",rightClass:"align-right",forceFollow:!0},t.prototype._init=function(){var e=this.$element.find("li.is-dropdown-submenu-parent");this.$element.children(".is-dropdown-submenu-parent").children(".is-dropdown-submenu").addClass("first-sub"),this.$menuItems=this.$element.find('[role="menuitem"]'),this.$tabs=this.$element.children('[role="menuitem"]'),this.isVert=this.$element.hasClass(this.options.verticalClass),this.$tabs.find("ul.is-dropdown-submenu").addClass(this.options.verticalClass),this.$element.hasClass(this.options.rightClass)||"right"===this.options.alignment||n.rtl()?(this.options.alignment="right",e.addClass("is-left-arrow opens-left")):e.addClass("is-right-arrow opens-right"),this.isVert||this.$tabs.filter(".is-dropdown-submenu-parent").removeClass("is-right-arrow is-left-arrow opens-right opens-left").addClass("is-down-arrow"),this.changed=!1,this._events()},t.prototype._events=function(){var t=this,i="ontouchstart"in window||"undefined"!=typeof window.ontouchstart,o="is-dropdown-submenu-parent";(this.options.clickOpen||i)&&this.$menuItems.on("click.zf.dropdownmenu touchstart.zf.dropdownmenu",function(n){var s=e(n.target).parentsUntil("ul","."+o),r=s.hasClass(o),d="true"===s.attr("data-is-click");s.children(".is-dropdown-submenu");if(r)if(d){if(!t.options.closeOnClick||!t.options.clickOpen&&!i||t.options.forceFollow&&i)return;n.stopImmediatePropagation(),n.preventDefault(),t._hide(s)}else n.preventDefault(),n.stopImmediatePropagation(),t._show(s.children(".is-dropdown-submenu")),s.add(s.parentsUntil(t.$element,"."+o)).attr("data-is-click",!0)}),this.options.disableHover||this.$menuItems.on("mouseenter.zf.dropdownmenu",function(n){n.stopImmediatePropagation();var i=e(this),s=i.hasClass(o);s&&(clearTimeout(t.delay),t.delay=setTimeout(function(){t._show(i.children(".is-dropdown-submenu"))},t.options.hoverDelay))}).on("mouseleave.zf.dropdownmenu",function(n){var i=e(this),s=i.hasClass(o);if(s&&t.options.autoclose){if("true"===i.attr("data-is-click")&&t.options.clickOpen)return!1;clearTimeout(t.delay),t.delay=setTimeout(function(){t._hide(i)},t.options.closingTime)}}),this.$menuItems.on("keydown.zf.dropdownmenu",function(i){var o,s,r=e(i.target).parentsUntil("ul",'[role="menuitem"]'),d=t.$tabs.index(r)>-1,a=d?t.$tabs:r.siblings("li").add(r);a.each(function(n){return e(this).is(r)?(o=a.eq(n-1),void(s=a.eq(n+1))):void 0});var l=function(){r.is(":last-child")||s.children("a:first").focus()},u=function(){o.children("a:first").focus()},p=function(){var e=r.children("ul.is-dropdown-submenu");e.length&&(t._show(e),r.find("li > a:first").focus())},h=function(){var e=r.parent("ul").parent("li");e.children("a:first").focus(),t._hide(e)},c={open:p,close:function(){t._hide(t.$element),t.$menuItems.find("a:first").focus()},handled:function(){i.preventDefault(),i.stopImmediatePropagation()}};d?t.vertical?"left"===t.options.alignment?e.extend(c,{down:l,up:u,next:p,previous:h}):e.extend(c,{down:l,up:u,next:h,previous:p}):e.extend(c,{next:l,previous:u,down:p,up:h}):"left"===t.options.alignment?e.extend(c,{next:p,previous:h,down:l,up:u}):e.extend(c,{next:h,previous:p,down:l,up:u}),n.Keyboard.handleKey(i,"DropdownMenu",c)})},t.prototype._addBodyHandler=function(){var n=e(document.body),t=this;n.off("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu").on("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu",function(e){var i=t.$element.find(e.target);i.length||(t._hide(),n.off("mouseup.zf.dropdownmenu touchend.zf.dropdownmenu"))})},t.prototype._show=function(t){var i=this.$tabs.index(this.$tabs.filter(function(n,i){return e(i).find(t).length>0})),o=t.parent("li.is-dropdown-submenu-parent").siblings("li.is-dropdown-submenu-parent");this._hide(o,i),t.css("visibility","hidden").addClass("js-dropdown-active").attr({"aria-hidden":!1}).parent("li.is-dropdown-submenu-parent").addClass("is-active").attr({"aria-expanded":!0});var s=n.Box.ImNotTouchingYou(t,null,!0);if(!s){var r="left"===this.options.alignment?"-right":"-left",d=t.parent(".is-dropdown-submenu-parent");d.removeClass("opens"+r).addClass("opens-"+this.options.alignment),s=n.Box.ImNotTouchingYou(t,null,!0),s||d.removeClass("opens-"+this.options.alignment).addClass("opens-inner"),this.changed=!0}t.css("visibility",""),this.options.closeOnClick&&this._addBodyHandler(),this.$element.trigger("show.zf.dropdownmenu",[t])},t.prototype._hide=function(e,n){var t;t=e&&e.length?e:void 0!==n?this.$tabs.not(function(e,t){return e===n}):this.$element;var i=t.hasClass("is-active")||t.find(".is-active").length>0;if(i){if(t.find("li.is-active").add(t).attr({"aria-expanded":!1,"data-is-click":!1}).removeClass("is-active"),t.find("ul.js-dropdown-active").attr({"aria-hidden":!0}).removeClass("js-dropdown-active"),this.changed||t.find("opens-inner").length){var o="left"===this.options.alignment?"right":"left";t.find("li.is-dropdown-submenu-parent").add(t).removeClass("opens-inner opens-"+this.options.alignment).addClass("opens-"+o),this.changed=!1}this.$element.trigger("hide.zf.dropdownmenu",[t])}},t.prototype.destroy=function(){this.$menuItems.off(".zf.dropdownmenu").removeAttr("data-is-click").removeClass("is-right-arrow is-left-arrow is-down-arrow opens-right opens-left opens-inner"),e(document.body).off(".zf.dropdownmenu"),n.Nest.Burn(this.$element,"dropdown"),n.unregisterPlugin(this)},n.plugin(t,"DropdownMenu")}(jQuery,window.Foundation);